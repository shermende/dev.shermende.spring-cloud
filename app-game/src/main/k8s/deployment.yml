apiVersion: apps/v1
kind: Deployment
metadata:
  name: app-game
  namespace: app-game
spec:
  replicas: 2
  selector:
    matchLabels:
      app.kubernetes.io/name: app-game
  template:
    metadata:
      name: app-game
      labels:
        app.kubernetes.io/name: app-game
    spec:
      containers:
        - name: app-game
          image: app-game:0.0.1
          volumeMounts:
            - name: volume-config-app-game
              mountPath: /etc/configmap
            - name: volume-secret-app-game
              mountPath: /etc/secret
          env:
            - name: spring.profiles.active
              value: kubernetes,jwt
            - name: spring.cloud.kubernetes.enabled
              value: "true"
            - name: spring.cloud.kubernetes.discovery.enabled
              value: "true"
            - name: spring.cloud.kubernetes.config.enabled
              value: "true"
            - name: spring.cloud.kubernetes.secrets.enabled
              value: "true"
#            - name: logging.config
#              value: logging.config=/etc/configmap/logback.xml
      volumes:
        - name: volume-secret-app-game
          secret:
            secretName: app-game
        - name: volume-config-app-game
          configMap:
            name: app-game
      serviceAccountName: app-game-sa